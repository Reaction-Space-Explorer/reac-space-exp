// Match the 4 major structures for the autocatalytic pattern match

// 0. Ring structure
MATCH ringPath=(beginMol:Molecule)-[*6..8]->(beginMol:Molecule)
WITH NODES(ringPath) AS ringNodes, ringPath, beginMol
UNWIND ringNodes AS rN
WITH [node in NODES(ringPath) WHERE (node:Molecule) | node.smiles_str] AS ringMols, ringPath, relationships(ringPath) as ringRels, beginMol, [node in NODES(ringPath) WHERE (node:Reaction) | node.id] AS rxn_ids
WHERE size(ringMols) > 2
AND size(ringRels) = (size(ringMols) - 1) * 2 // beginMol is double counted, hence the -1. ringMols only includes molecule nodes, not reaction node, so double the number of molecule nodes to get the number of molecule nodes + number of reaction nodes. Then, the number of reaction nodes + molecule nodes should equal the total number of edges in the ring. Any less edges means the pattern is not a ring shape; it is probably a deformed figure 8 looking shape
//RETURN ringMols, ringPath, ringRels, rxn_ids // , size(ringRels), size(ringMols)
//LIMIT 1

// 1. Molecule in ring splitting to form the beginMol (autocatalytic cord structure)
MATCH autocatPath=(catRxnInRing:Reaction)-[*3..5]->(beginMol:Molecule)
WHERE catRxnInRing.id IN rxn_ids
WITH ringMols, ringPath, ringRels, beginMol, catRxnInRing, autocatPath, relationships(autocatPath) as autocatPathRels, nodes(autocatPath) as autocatPathNodes
RETURN ringMols, ringPath, ringRels, beginMol, catRxnInRing, autocatPath, relationships(autocatPath) as autocatPathRels, nodes(autocatPath) as autocatPathNodes
LIMIT 1



// 2. Ring consumer structure





// 3. Feeder structure



// Finally, return 1 matching structure to look at! (Tabulate results of many using a different query)